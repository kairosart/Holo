Continuing with situational awareness, we can begin looking for any interesting configuration files or other pieces of information that we can gather without actively exploiting the box. We can also attempt to loot services on the device, such as MySQL.  

Since we know the server we are attacking is a web server, we can assume it runs some SQL or database on the backend. Often, these databases may be secure from someone accessing them from the outside, but when on the server, they are often very insecure and can openly read the configuration files.

When we get onto a server running MySQL, we can begin our situational awareness and information looting/exfiltration by reading the `db_connect.php` file. Web servers require this file to connect PHP and SQL. This file is often not readable externally, but you can easily read it and obtain information from it if you have access to an insecure internal server. This file will typically be present at the root of the web page, such as `/var/www`. Find an example of this configuration file below.  

`<?php   define('DB_SRV', '127.0.0.1');   define('DB_PASSWD', 'password');   define('DB_USER', 'username');   define('DB_NAME', 'database');   $connection = mysqli_connect(DB_SRV, DB_USER, DB_PASSWD, DB_NAME);   ?>`

As you can see, we can get much important information from this file: server address, password, username, database name. This can help us to then access and loot the database. It is essential to understand the scope and what information you can and cant exfiltrate and loot. Before exfiltration, you should have clear communication and plans with your target. Hololive has permitted you to exfiltrate names and passwords within the "DashboardDB" database in this engagement.

To access the database, you will need to utilize a binary of the database access tool used. The database will often be MySQL; however, this can change from server to server, and location may also vary. To use MySQL, you will only need to specify the username using `-u`. You will also need to specify the `-p` parameter; however, it does not take an argument.

When directly accessing a database using MySQL, it will put you into a local database hosted on the machine. You can also use MySQL to access remote databases using the `-h` parameter. Find an example of usage below.  

Syntax: `mysql -u <username> -p -h 127.0.0.1`

If successful, we should now have access to a remote database. From here, we can use SQL syntax to navigate and utilize the database. We will be covering a few essential SQL commands that you can use to understand how to navigate a SQL database quickly. For more information, check out the MySQL documentation. [https://dev.mysql.com/doc/](https://dev.mysql.com/doc/).   

- `show databases;` provides a list of available databases.
- `use <database>;` navigates to the provided database.
- `show tables;` provides a list of available tables within the database.
- `show columns from <table>;` outputs columns of the provided table.
- `select * from <table>;` outputs all contents of the provided table.


---

# Your job

- On the Reverse Shell go to `/var/www/admin`.
- There's a file called `db_connect.php` where there are interesting information.
	define('DB_SRV', '192.168.100.1');
	define('DB_PASSWD', "!123SecureAdminDashboard321!");
	define('DB_USER', 'admin');
	define('DB_NAME', 'DashboardDB');

This gives us all the information we need to connect. We can assume this is a mySQL server, as it’s running on port 3306 which is the default. Therefore, we can use the mysql command line tool to access it.
## Accessing the local database

Run the following on the shell:
`mysql -u admin -p -h 192.168.100.1 `

Password: `!123SecureAdminDashboard321!`

### Show all databases

mysql> `show databases`

![[Task 17 - Dorkus Storkus - Protector of the Database-20240911151650568.webp]]
### Select DashboardDB database

mysql> `use DashboardDB;`


### List of all the tables in this database

mysql> `show tables;`

![[Task 17 - Dorkus Storkus - Protector of the Database-20240911151811531.webp]]

### List users' table rows

mysql> `SELECT * FROM users;`

![[Task 17 - Dorkus Storkus - Protector of the Database-20240911152009979.webp]]



---

## Answer the questions below

> [!question]
> What is the server address of the remote database?
> `192.168.100.1`
> What is the password of the remote database?
> `!123SecureAdminDashboard321!`
> What is the username of the remote database?
> `admin`
> What is the database name of the remote database?
> `DashboardDB`
> What username can be found within the database itself?
> `gurag`


**Next step:** [[Task 18 - Making Thin Lizzy Proud]]
